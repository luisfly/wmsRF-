@{
    ViewBag.Title = "仓储拼板";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
   <div class="box">
      <table  cellpadding="0" cellspacing="1">
       <tr>
           <td class="title">原始托盘</td>
           <td class="content">
              <input id="txtOldTrayNO" name="txtOldTrayNO" type="text" class="tdInput"  />
           </td>
       </tr>
       <tr>
          <td class="title">目标托盘</td>
          <td class="content">
             <input id="txtTrayNO" name="txtTrayNO" type="text" class="tdInput"  />
          </td>
       </tr>
     </table>
   </div>
<script  type="text/javascript">
    $(document).ready(function () {
        //SetInputDisabled(1);
        $("#txtTrayNO").attr("disabled", "disabled");
        $("#txtOldTrayNO").keypress(function (e) {
            if (e.which == 13) {
                // window.focus();
                ValidateOldTrayNO();
            }
        }).blur();
        //===================================
        $("#txtTrayNO").keypress(function (e) {
            if (e.which == 13) {
                //window.focus();
                ValidateTrayNO();
            }
        }).blur();
        $("#txtOldTrayNO").focus();
        //===================================================
    });
function SetInputDisabled(index)
{
    var ip= $("input[type=text]");
    var i=0;
    ip.each(function(){
      i++;
      if(i==index)
      {
        $(this).focus();
      }
      if(i>index)
      {
         $(this).attr("disabled","disabled");
      }
      else
      {
          $(this).attr("disabled","")
      }
    })
}
function SetParams()
{
   var params={"model.OldTrayNO": $("#txtOldTrayNO").val(),
   "model.TrayNO": $("#txtTrayNO").val()};
   return params;
}
function ValidateOldTrayNO() {
    $("#Loading").css("visibility", "visible");
    $("#Msg").css("visibility", "hidden")
    $("#Msg").html("");
    var url="/PastesCCH/ValidateOldTrayNO";
    var params=SetParams();
    $.post(url, params, function (data, textStatus) {
        if (data != "") {
            $("#Loading").css("visibility", "hidden");
            $("#Msg").html(data);
            $("#Msg").css("visibility", "visible");
            //SetInputDisabled(1);
            $("#txtTrayNO").attr("disabled", "disabled");
            $("#txtOldTrayNO").select();
            return false;
        }
        else {
            $("#Loading").css("visibility", "hidden");
            $("#Msg").css("visibility", "hidden")
            $("#Msg").html("");
            //SetInputDisabled(2);
            $("#txtTrayNO").attr("disabled", "")
            $("#txtTrayNO").select();
            return true;
        }
    });
}
function ValidateTrayNO() {
    $("#Loading").css("visibility", "visible");
    $("#Msg").css("visibility", "hidden")
    $("#Msg").html("");
    var url="/PastesCCH/ValidateTrayNO";
    var params=SetParams();
    $.post(url, params, function (data, textStatus) {
        if (data != "") {
            $("#Loading").css("visibility", "hidden");
            $("#Msg").css("visibility", "visible");
            $("#Msg").html(data);
            
            $("#txtTrayNO").select();
  
            //SetInputDisabled(2);
            return false;
        }
        else {
            $("#Loading").css("visibility", "hidden");
            $("#Msg").html("操作成功!");
            $("#Msg").css("visibility", "visible");
            $("#txtOldTrayNO").val("");
            $("#txtTrayNO").val("")
            //SetInputDisabled(1);
            $("#txtTrayNO").attr("disabled", "disabled");
            $("#txtOldTrayNO").focus();
            return true;
        }

    });
}
</script>  

